{#
| Variable         | Type    | Description                     |
|------------------|---------|---------------------------------|
| cart             | object  |                                 |
| cart.items_count | int     |                                 |
| cart.total       | string  | Formatted total ex: "١٠٠ ر.س"   |
#}
{% set important_links = theme.settings.get('important_links') %}

<header class="store-header sticky top-0 z-50 bg-white/95 backdrop-blur-md shadow-sm transition-all duration-300 border-b border-gray-100" id="main-header">
  {# Top Bar - Professional Dark #}
  {% if theme.settings.get('important_links') or store.settings.is_multilingual or store.settings.currencies_enabled %}
  <div class="bg-primary text-white py-2 text-xs hidden md:block transition-colors duration-300">
    <div class="container flex justify-between items-center">
      <div class="flex items-center gap-6">
        {% if theme.settings.get('important_links') %}
          <salla-menu source="footer" topnav class="flex gap-6 text-gray-300 hover:text-white transition-colors font-medium"></salla-menu>
        {% endif %}
      </div>
      <div class="flex items-center gap-6">
         <salla-contacts is-header class="flex gap-4 text-gray-300 hover:text-white transition-colors"></salla-contacts>
         
         {% if store.settings.is_multilingual or store.settings.currencies_enabled %}
            <button type="button" onclick="salla.event.dispatch('localization::open')" class="flex items-center gap-2 text-gray-300 hover:text-white transition-colors py-1 px-2 rounded hover:bg-white/10">
                <span class="font-bold">{{ user.language.name }}</span>
                <span class="opacity-50">|</span> 
                <span>{{ currency.symbol }}</span>
                <i class="sicon-keyboard_arrow_down text-[10px]"></i>
            </button>
            <salla-localization-modal></salla-localization-modal>
         {% endif %}
      </div>
    </div>
  </div>
  {% endif %}

  {# Main Header #}
  <div class="container py-3 md:py-5">
      <div class="flex items-center justify-between gap-4 md:gap-8">
          {# Logo & Mobile Menu #}
          <div class="flex items-center gap-4 shrink-0">
              <button class="lg:hidden text-gray-700 hover:text-primary transition-colors p-2 rounded-md hover:bg-gray-50" onclick="salla.event.dispatch('mobile-menu::open')" aria-label="Open menu">
                <i class="sicon-menu text-2xl"></i>
              </button>
              
              <a class="block w-28 md:w-36 lg:w-44 transition-transform hover:scale-105 duration-300" href="{{ store.url }}">
                  <img fetchpriority="high" width="100%" height="100%" loading="eager" src="{{ store.logo }}" alt="{{ store.name }} logo" class="object-contain max-h-12 md:max-h-16">
                  {% if is_page('index') %}
                    <h1 class="sr-only">{{ store.name }}</h1>
                  {% else %}
                    <h2 class="sr-only">{{ store.name }}</h2>
                  {% endif %}
              </a>
          </div>

          {# Desktop Menu #}
          <div class="hidden lg:block flex-1 px-8">
             <custom-main-menu class="flex justify-center gap-8 text-base font-medium text-gray-600 hover:text-primary transition-colors"></custom-main-menu>
          </div>

          {# Search & Actions #}
          <div class="flex items-center gap-3 md:gap-5 shrink-0">
              {# Search #}
              <div class="hidden md:block w-64 xl:w-96 transition-all duration-300 focus-within:w-full focus-within:max-w-lg">
                <salla-search inline oval height="44" class="w-full shadow-sm border-gray-200 focus-within:border-primary focus-within:ring-1 focus-within:ring-primary/20"></salla-search>
              </div>
              <button class="md:hidden text-gray-700 hover:text-primary p-2 rounded-full hover:bg-gray-50 transition-colors" onclick="salla.event.dispatch('search::open')">
                <i class="sicon-search text-xl"></i>
              </button>

              {# User Menu #}
              {% if user.type=='user' %}
                <salla-user-menu avatar-only show-header class="text-gray-700 hover:text-primary transition-colors"></salla-user-menu>
              {% else %}
                  <button class="text-gray-700 hover:text-primary p-2 rounded-full hover:bg-gray-50 transition-colors" aria-label="Login" onclick="salla.event.dispatch('login::open')">
                    <i class="sicon-user-circle text-2xl"></i>
                  </button>
              {% endif %}

              {# Cart #}
              <button type="button" onclick="salla.event.dispatch('cart::open')" class="group relative text-gray-700 hover:text-primary p-2 rounded-full hover:bg-gray-50 transition-colors cursor-pointer ml-0">
                  <i class="sicon-shopping-bag text-2xl group-hover:scale-110 transition-transform duration-300"></i>
                  <span class="badge absolute top-0 right-0 bg-accent text-white text-[10px] font-bold h-5 w-5 rounded-full flex items-center justify-center shadow-sm ring-2 ring-white transform scale-100 group-hover:scale-110 transition-all duration-300" data-cart-count>
                      {{ cart.items_count }}
                  </span>
              </button>
          </div>
      </div>
  </div>
</header>

{% if store.scope %}
    <salla-scopes selection="{{ store.scope.display_as == 'popup' ? 'mandatory' : 'optional' }}"></salla-scopes>
{% endif %}
